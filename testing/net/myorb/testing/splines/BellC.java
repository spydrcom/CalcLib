
package net.myorb.testing.splines;

import net.myorb.math.MultiDimensional;

import net.myorb.math.expressions.symbols.SplineInRealDomain;

import java.util.ArrayList;

public class BellC extends SplineInRealDomain
{

	public void initialize ()
	{
		setName ("BellC");
		setHiConstraint (3.000000000000001);
		setSegmentLoConstraints (-2.7755575615628914E-17, 1.0, 2.0);
		addSegmentChebyshevPolynomial (0.6311258156398641, 0.02631169399755623, -0.3350443824803817, 0.01659634510866023, 0.02787060344702926, 0.006032491027671179, -0.005959198432724967, 9.460728639288777E-4);
		addSegmentChebyshevPolynomial (3.0434241489312557, -4.233526014322643, 2.585463328875858, -1.518374112000485, 0.63123565049707, -0.16362563432023897, 0.025374612556109274, -0.00217192408760207, 7.93850422799909E-5);
		addSegmentChebyshevPolynomial (1.7060273405606234, -1.0679351020720844, -0.5761752364416797, 0.44566703357650117, -0.12161123597827972, 0.017057589733348217, -0.0012364216593793592, 3.686837620341588E-5);
	}

	public static void main (String[] args)
	{
		ArrayList<Double> a = new ArrayList<> ();
		MultiDimensional.Function<Double> bell = (new BellC ()).getFunction ();
		for (double x = 0; x <= 2.5; x += 0.01) a.add (bell.f(x));
		System.out.println (a);
	}

	/*

a = (1.0, 0.9999005979257615, 0.9996011955333208, 0.9991019681153207, 0.9984032126069633, 0.9975053471396506, 0.9964089104664762, 0.9951145612626273, 0.9936230773037423, 0.9919353545252806, 0.9900524059659518, 0.9879753605982603, 0.9857054620492135, 0.9832440672142465, 0.9805926447674166, 0.9777527735709156, 0.9747261409869552, 0.971514541095075, 0.9681198728179251, 0.9645441379585766, 0.9607894391524076, 0.9568579777366218, 0.9527520515404475, 0.9484740525990685, 0.9440264647943418, 0.9394118614253509, 0.9346329027118466, 0.9296923332336282, 0.9245929793089156, 0.9193377463147656, 0.913929615952581, 0.9083716434617682, 0.9026669547845901, 0.8968187436852721, 0.8908302688264061, 0.8847048508057092, 0.8784458691561872, 0.872056759312753, 0.8655410095483544, 0.8589021578826608, 0.8521437889663608, 0.8452695309441224, 0.8382830522992701, 0.8311880586832245, 0.8239882897327628, 0.8166875158781469, 0.8092895351451734, 0.8017981699541972, 0.7942172639191771, 0.7865506786498004, 0.7788022905597332, 0.7709759876840504, 0.7630756665088985, 0.755105228816438, 0.7470685785481229, 0.7389696186893652, 0.730812248178636, 0.7226003588440586, 0.7143378323705394, 0.7060285373004935, 0.6976763260712143, 0.6892850320919378, 0.6808584668636566, 0.6724004171447306, 0.6639146421653511, 0.6554048708939051, 0.6468747993582957, 0.6383280880252672, 0.6297683592407879, 0.6211991947345428, 0.6126241331915852, 0.6040466678942034, 0.5954702444370492, 0.5868982585185836, 0.5783340538118886, 0.5697809199178996, 0.5612420904041077, 0.5527207409317835, 0.5442199874747768, 0.5357428846329406, 0.5272924240432328, 0.5188715328915465, 0.510483072528322, 0.5021298371909899, 0.49381455283629866, 0.4855398760855776, 0.4773083932859877, 0.46912261969081015, 0.46098499876182664, 0.45289790159684074, 0.4448636264853944, 0.4368843985957286, 0.4289623697960425, 0.4210996186130996, 0.41329815033123635, 0.40555989723482216, 0.3978867189972219, 0.390280403219316, 0.38274266612062585, 0.3752751533860985, 0.36787944117160354, 0.3605587982603726, 0.3533131694357601, 0.34614391716353743, 0.3390523307474691, 0.33203962680784627, 0.3251069498257717, 0.3182553727504136, 0.3114858976665178, 0.30479945651948714, 0.2981969118953942, 0.29167905785330617, 0.2852466208073958, 0.2789002604562767, 0.2726405707571229, 0.2664680809421087, 0.2603832565747859, 0.25438650064403867, 0.24847815469329437, 0.24265849998273814, 0.23692775868227023, 0.23128609509303466, 0.22573361689535854, 0.22027037642100344, 0.21489637194763755, 0.20961154901353485, 0.2044158017504798, 0.19930897423294347, 0.19429086184165323, 0.18936121263963868, 0.18451972875897882, 0.17976606779644788, 0.17509984421631453, 0.17052063075860469, 0.16602795985116625, 0.1616213250239067, 0.15730018232365728, 0.15306395172807408, 0.14891201855714886, 0.14484373488080182, 0.14085842092121403, 0.13695536644847284, 0.13313383216822228, 0.12939305110003474, 0.12573222994523592, 0.12215055044298717, 0.11864717071345154, 0.11522122658692124, 0.11187183291783054, 0.10859808488257139, 0.10539905926016546, 0.10227381569478755, 0.09922139793920959, 0.09624083507835479, 0.09333114273202314, 0.09049132423607054, 0.08772037180124581, 0.085017267648964, 0.08238098512335856, 0.07981048977900018, 0.0773047404436018, 0.07486269025525649, 0.07248328767364276, 0.07016547746475243, 0.0679082016586503, 0.0657104004799729, 0.06357101325074588, 0.061488979265234445, 0.059463238636570104, 0.057492733114889116, 0.05557640687688359, 0.05371320728651474, 0.05190208562687504, 0.05014199780305395, 0.04843190501610506, 0.04677077440799993, 0.045157579677752135, 0.043591301668671534, 0.04207092892707642, 0.04059545823250987, 0.03916389509965601, 0.03777525425243988, 0.036428560070316696, 0.03512284700739432, 0.03385715998446548, 0.032630554754765395, 0.03144209824348776, 0.03029086886196053, 0.02917595679684215, 0.028096464274864452, 0.027051505803953546, 0.026040208391283848, 0.025061711738963766, 0.024115168418191946, 0.02319974402261371, 0.022314617301785855, 0.021458980275526507, 0.02063203833019367, 0.01983301029777884, 0.01906112851881403, 0.018315638888757757, 0.01759589808028772, 0.01690104493181055, 0.016230368242037496, 0.015583171284377029, 0.014958771702121343, 0.014356501399248378, 0.013775706427037848, 0.013215746866541478, 0.012675996707093518, 0.012155843720919268, 0.011654689334038792, 0.011171948493482242, 0.010707049531053059, 0.010259434023617953, 0.009828556650228304, 0.0094138850459633, 0.00901489965283142, 0.008631093567719628, 0.008261972387518801, 0.007907054051605078, 0.007565868681752574, 0.007237958419570756, 0.006922877261660965, 0.006620190892549616, 0.006329476515518406, 0.00605032268149408, 0.0057823291160779, 0.005525106544839398, 0.005278276517015179, 0.005041471227706484, 0.004814333338682308, 0.0045965157979892535, 0.00438768165835457, 0.004187503894618416, 0.003995665220272393, 0.00381185790316918, 0.0036357835806464234, 0.0034671530740391088, 0.003305686202824898, 0.0031511115984446114, 0.0030031665179299782, 0.002861596657483423, 0.0027261559661060364, 0.0025966064593929694, 0.0024727180336328036, 0.0023542682803054937, 0.002241042301126761, 0.0021328325237202073, 0.002029438518054816, 0.001930666813836357)

calc a
(1, 0.9999005979257615, 0.9996011955333208, 0.9991019681153207, 0.9984032126069633, 0.9975053471396506, 0.9964089104664762, 0.9951145612626273, 0.9936230773037423, 0.9919353545252806, 0.9900524059659518, 0.9879753605982603, 0.9857054620492135, 0.9832440672142465, 0.9805926447674166, 0.9777527735709156, 0.9747261409869552, 0.971514541095075, 0.9681198728179251, 0.9645441379585766, 0.9607894391524076, 0.9568579777366218, 0.9527520515404475, 0.9484740525990685, 0.9440264647943418, 0.9394118614253509, 0.9346329027118466, 0.9296923332336282, 0.9245929793089156, 0.9193377463147656, 0.913929615952581, 0.9083716434617682, 0.9026669547845901, 0.8968187436852721, 0.8908302688264061, 0.8847048508057092, 0.8784458691561872, 0.872056759312753, 0.8655410095483544, 0.8589021578826608, 0.8521437889663608, 0.8452695309441224, 0.8382830522992701, 0.8311880586832245, 0.8239882897327628, 0.8166875158781469, 0.8092895351451734, 0.8017981699541972, 0.7942172639191771, 0.7865506786498004, 0.7788022905597332, 0.7709759876840504, 0.7630756665088985, 0.755105228816438, 0.7470685785481229, 0.7389696186893652, 0.730812248178636, 0.7226003588440586, 0.7143378323705394, 0.7060285373004935, 0.6976763260712143, 0.6892850320919378, 0.6808584668636566, 0.6724004171447306, 0.6639146421653511, 0.6554048708939051, 0.6468747993582957, 0.6383280880252672, 0.6297683592407879, 0.6211991947345428, 0.6126241331915852, 0.6040466678942034, 0.5954702444370492, 0.5868982585185836, 0.5783340538118886, 0.5697809199178996, 0.5612420904041077, 0.5527207409317835, 0.5442199874747768, 0.5357428846329406, 0.5272924240432328, 0.5188715328915465, 0.510483072528322, 0.5021298371909899, 0.49381455283629866, 0.4855398760855776, 0.4773083932859877, 0.46912261969081015, 0.46098499876182664, 0.45289790159684074, 0.4448636264853944, 0.4368843985957286, 0.4289623697960425, 0.4210996186130996, 0.41329815033123635, 0.40555989723482216, 0.3978867189972219, 0.390280403219316, 0.38274266612062585, 0.3752751533860985, 0.36787944117160354, 0.3605587982603726, 0.3533131694357601, 0.34614391716353743, 0.3390523307474691, 0.33203962680784627, 0.3251069498257717, 0.3182553727504136, 0.3114858976665178, 0.30479945651948714, 0.2981969118953942, 0.29167905785330617, 0.2852466208073958, 0.2789002604562767, 0.2726405707571229, 0.2664680809421087, 0.2603832565747859, 0.25438650064403867, 0.24847815469329437, 0.24265849998273814, 0.23692775868227023, 0.23128609509303466, 0.22573361689535854, 0.22027037642100344, 0.21489637194763755, 0.20961154901353485, 0.2044158017504798, 0.19930897423294347, 0.19429086184165323, 0.18936121263963868, 0.18451972875897882, 0.17976606779644788, 0.17509984421631453, 0.17052063075860469, 0.16602795985116625, 0.1616213250239067, 0.15730018232365728, 0.15306395172807408, 0.14891201855714886, 0.14484373488080182, 0.14085842092121403, 0.13695536644847284, 0.13313383216822228, 0.12939305110003474, 0.12573222994523592, 0.12215055044298717, 0.11864717071345154, 0.11522122658692124, 0.11187183291783054, 0.10859808488257139, 0.10539905926016546, 0.10227381569478755, 0.09922139793920959, 0.09624083507835479, 0.09333114273202314, 0.09049132423607054, 0.08772037180124581, 0.085017267648964, 0.08238098512335856, 0.07981048977900018, 0.0773047404436018, 0.07486269025525649, 0.07248328767364276, 0.07016547746475243, 0.0679082016586503, 0.0657104004799729, 0.06357101325074588, 0.061488979265234445, 0.059463238636570104, 0.057492733114889116, 0.05557640687688359, 0.05371320728651474, 0.05190208562687504, 0.05014199780305395, 0.04843190501610506, 0.04677077440799993, 0.045157579677752135, 0.043591301668671534, 0.04207092892707642, 0.04059545823250987, 0.03916389509965601, 0.03777525425243988, 0.036428560070316696, 0.03512284700739432, 0.03385715998446548, 0.032630554754765395, 0.03144209824348776, 0.03029086886196053, 0.02917595679684215, 0.028096464274864452, 0.027051505803953546, 0.026040208391283848, 0.025061711738963766, 0.024115168418191946, 0.02319974402261371, 0.022314617301785855, 0.021458980275526507, 0.02063203833019367, 0.01983301029777884, 0.01906112851881403, 0.018315638888757757, 0.01759589808028772, 0.01690104493181055, 0.016230368242037496, 0.015583171284377029, 0.014958771702121343, 0.014356501399248378, 0.013775706427037848, 0.013215746866541478, 0.012675996707093518, 0.012155843720919268, 0.011654689334038792, 0.011171948493482242, 0.010707049531053059, 0.010259434023617953, 0.009828556650228304, 0.0094138850459633, 0.00901489965283142, 0.008631093567719628, 0.008261972387518801, 0.007907054051605078, 0.007565868681752574, 0.007237958419570756, 0.006922877261660965, 0.006620190892549616, 0.006329476515518406, 0.00605032268149408, 0.0057823291160779, 0.005525106544839398, 0.005278276517015179, 0.005041471227706484, 0.004814333338682308, 0.0045965157979892535, 0.00438768165835457, 0.004187503894618416, 0.003995665220272393, 0.00381185790316918, 0.0036357835806464234, 0.0034671530740391088, 0.003305686202824898, 0.0031511115984446114, 0.0030031665179299782, 0.002861596657483423, 0.0027261559661060364, 0.0025966064593929694, 0.0024727180336328036, 0.0023542682803054937, 0.002241042301126761, 0.0021328325237202073, 0.002029438518054816, 0.001930666813836357)

graph [0 < i < 200] (a#i) 

	 */
	/*

READ FloatDemoChebyshevSegmented.txt

SCRIPTPRINT FloatDemoChebyshevSegmented.txt

// constants for approximation purposes
INFINITY = 1000; dt = 1 / INFINITY

// create an array function describing the curve
curve = [-3 <= t <= 3.5 <> dt] ( exp ( - t ^ 2 ) ) 

// select segment domains and collect samples

seg1 = [-0.2 <= t <= 1.2 <> 0.2] ( curve @# t )
seg2 = [0.8 <= t <= 2.4 <> 0.2] ( curve @# t )
seg3 = [1.8 <= t <= 3.4 <> 0.2] ( curve @# t )

s1poly = CHEBINTERP seg1
s2poly = CHEBINTERP seg2
s3poly = CHEBINTERP seg3

!$ BellC(x) = (s1poly, s2poly, s3poly)

GRAPH [0 <= x <= 3 <> 0.001] (BellC (x))

// evaluation of the error curve

!! P(x) = BellC(x)
!! f(x) = curve @# x

err = [0 <= x <= 3 <> 0.001] (abs (P(x) - f(x)))

maxError = MAX err 
PRETTYPRINT maxError 
GRAPH err

encode BellC

LIBRARY XPF a.sample.library.ExportedFunctions

!+ BELLCX(x) = XPF.bellc

GRAPH [0 <= x <= 3 <> 0.001] ( BELLCX(x) )



Chebyshev Interpolation

	 Y = 0.63113 * T[0](x) + 0.02631 * T[1](x) - 0.33504 * T[2](x) + 0.0166 * T[3](x) + 0.02787 * T[4](x) + 0.00603 * T[5](x) - 0.00596 * T[6](x) + 0.00095 * T[7](x)

r^2 = 1.0
STD = 1.1830084923285172E-16
COV = 1.6889569508434738E-16
MSE = 1.3995090929213912E-32
SSE = 8.397054557528348E-32
SSR = 0.6037417381563968
SST = 0.6037417381563965

Chebyshev Interpolation

	 Y = 3.04342 * T[0](x) - 4.23353 * T[1](x) + 2.58546 * T[2](x) - 1.51837 * T[3](x) + 0.63124 * T[4](x) - 0.16363 * T[5](x) + 0.02537 * T[6](x) - 0.00217 * T[7](x) + 0.00008 * T[8](x)

r^2 = 1.0
STD = 2.5228156550928536E-12
COV = 1.600319504926352E-11
MSE = 6.364598829581584E-24
SSE = 4.4552191807071087E-23
SSR = 0.2736000978145655
SST = 0.2736000978178316

Chebyshev Interpolation

	 Y = 1.70603 * T[0](x) - 1.06794 * T[1](x) - 0.57618 * T[2](x) + 0.44567 * T[3](x) - 0.12161 * T[4](x) + 0.01706 * T[5](x) - 0.00124 * T[6](x) + 0.00004 * T[7](x)

r^2 = 1.0
STD = 1.289824592900256E-14
COV = 1.4688452379395254E-12
MSE = 1.663647480450311E-28
SSE = 9.981884882701866E-28
SSR = 0.0013263617043913348
SST = 0.0013263617043919478

BellC is found to be continuous on the interval -2.7755575615628914E-17 to 3.000000000000001

	s1poly	-2.7755575615628914E-17	1.0	CHEBYSHEV
	s2poly	1.0	2.1999999999999997	CHEBYSHEV
	s3poly	2.0	3.000000000000001	CHEBYSHEV


maxError = 

	5.985661350960125E-6

	 */
}
